Script started on Wed Jan  9 17:29:57 2019
sh-4.4$ cd docker/
sh-4.4$ docker build . -t tommartensen/mocc-assignment-frontend -f frontend.Dockerfile
Sending build context to Docker daemon  10.75kB
Step 1/2 : FROM nginx
 ---> ae513a47849c
Step 2/2 : COPY frontend.nginx.conf /etc/nginx/nginx.conf
 ---> Using cache
 ---> ecb4dead97b3
Successfully built ecb4dead97b3
Successfully tagged tommartensen/mocc-assignment-frontend:latest
sh-4.4$ docker build . -t tommartensen/mocc-assignment-frontend -f frontend.Dockerfile                                 backend -f f backend.Dockerfile
Sending build context to Docker daemon  10.75kB
Step 1/2 : FROM nginx
 ---> ae513a47849c
Step 2/2 : COPY backend.nginx.conf /etc/nginx/nginx.conf
 ---> ae2e44b0731e
Successfully built ae2e44b0731e
Successfully tagged tommartensen/mocc-assignment-backend:latest
sh-4.4$ docker push tommartensen/mocc-assignment-frontend
The push refers to repository [docker.io/tommartensen/mocc-assignment-frontend]
0baf8f964756: Preparing
7ab428981537: Preparing
82b81d779f83: Preparing
d626a8ad97a1: Preparing
7ab428981537: Layer already exists
d626a8ad97a1: Layer already exists
0baf8f964756: Layer already exists
82b81d779f83: Layer already exists
latest: digest: sha256:f9cd594ff25c0755275fd8e0f6a26489538cf82651220696e8be8167c5c89007 size: 1155
sh-4.4$ docker push tommartensen/mocc-assignment-backend
The push refers to repository [docker.io/tommartensen/mocc-assignment-backend]
0baf8f964756: Preparing
7ab428981537: Preparing
82b81d779f83: Preparing
d626a8ad97a1: Preparing
0baf8f964756: Layer already exists
7ab428981537: Layer already exists
82b81d779f83: Layer already exists
d626a8ad97a1: Layer already exists
latest: digest: sha256:9f5f92338dd0e59b3a2a91152f6f3b7e735998cf1b5e70ac4273f23963ac25be size: 1155
sh-4.4$ kubectl get all
NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE
service/kubernetes   ClusterIP   10.96.0.1    <none>        443/TCP   91d
sh-4.4$ cd ..
sh-4.4$ kubectl create -f backend-deployment.yaml
deployment.apps "backend" created
sh-4.4$ kubectl expose deployment backend
service "backend" exposed
sh-4.4$ kubectl get all
NAME                           READY     STATUS    RESTARTS   AGE
pod/backend-5fbb9bcb58-7qhzd   1/1       Running   0          15s
pod/backend-5fbb9bcb58-8mnpq   1/1       Running   0          15s
pod/backend-5fbb9bcb58-m278p   1/1       Running   0          15s

NAME                 TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE
service/backend      ClusterIP   10.99.122.228   <none>        80/TCP    3s
service/kubernetes   ClusterIP   10.96.0.1       <none>        443/TCP   91d

NAME                      DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/backend   3         3         3            3           16s

NAME                                 DESIRED   CURRENT   READY     AGE
replicaset.apps/backend-5fbb9bcb58   3         3         3         16s
sh-4.4$ kubectl create -f frontend-deployment.yaml
deployment.apps "frontend" created
sh-4.4$ kubectl expose deployment frontend --type=NodePort
service "frontend" exposed
sh-4.4$ kubectl get all
NAME                            READY     STATUS    RESTARTS   AGE
pod/backend-5fbb9bcb58-7qhzd    1/1       Running   0          1m
pod/backend-5fbb9bcb58-8mnpq    1/1       Running   0          1m
pod/backend-5fbb9bcb58-m278p    1/1       Running   0          1m
pod/frontend-66dd69578b-5nhrr   1/1       Running   0          55s
pod/frontend-66dd69578b-lmr8f   1/1       Running   0          55s
pod/frontend-66dd69578b-vw9g7   1/1       Running   0          55s

NAME                 TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)        AGE
service/backend      ClusterIP   10.99.122.228   <none>        80/TCP         1m
service/frontend     NodePort    10.96.25.23     <none>        80:30114/TCP   2s
service/kubernetes   ClusterIP   10.96.0.1       <none>        443/TCP        91d

NAME                       DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/backend    3         3         3            3           1m
deployment.apps/frontend   3         3         3            3           55s

NAME                                  DESIRED   CURRENT   READY     AGE
replicaset.apps/backend-5fbb9bcb58    3         3         3         1m
replicaset.apps/frontend-66dd69578b   3         3         3         55s


sh-4.4$ kubectl get svc --selector=app=frontend -o jsonpath='{.items[*].spec.ports[*].nodePort}'
30114sh-4.4$ curl http://localhost:30114
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100    98  100    98    0     0     98      0  0:00:01 --:--:--  0:00:01  3161
Hello! You are 10.1.0.94 and requested /etc/nginx/html/ from 10.1.0.92 (backend-5fbb9bcb58-m278p)
sh-4.4$ exit
exit

Script done on Wed Jan  9 17:38:45 2019
